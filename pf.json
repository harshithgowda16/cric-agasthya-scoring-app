{
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "AzureUserName": { "type": "string" },
    "AzurePassword": { "type": "securestring" },
    "ODLID": { "type": "string" },
    "DeploymentID": { "type": "string" },
    "InstallCloudLabsShadow": {
      "type": "string",
      "defaultValue": "yes",
      "allowedValues": ["yes", "no"]
    },
    "trainerUserName": { "type": "string", "defaultValue": "trainer" },
    "trainerUserPassword": { "type": "string", "defaultValue": "Password.1!!" },
    "resetUserPassword": { "type": "string", "defaultValue": "prtg4training" },
    "vm1ImageId": { "type": "string" },
    "vm2ImageId": { "type": "string" },
    "vm3ImageId": { "type": "string" },
    "vm4ImageId": { "type": "string" }
  },
  "variables": {
    "cloudlabsCommon": "[concat(' -AzureUserName ', parameters('AzureUserName'), ' -AzurePassword ', parameters('AzurePassword'), ' -AzureTenantID ', variables('AzureTenantID'), ' -AzureSubscriptionID ', variables('AzureSubscriptionID'), ' -ODLID ', parameters('ODLID'), ' -InstallCloudLabsShadow ', parameters('InstallCloudLabsShadow'))]",
    "Enable-CloudLabsEmbeddedShadow": "[concat(' -vmAdminUsername ', variables('adminUsername'), ' -trainerUserName ', parameters('trainerUserName'), ' -trainerUserPassword ', parameters('trainerUserPassword'), ' -resetUserPassword ', parameters('resetUserPassword'))]",
    "AzureSubscriptionID": "[subscription().subscriptionId]",
    "AzureTenantID": "[subscription().tenantId]",
    "location": "[resourceGroup().location]",
    "diskType": "StandardSSD_LRS",
    "diskSizeGB": 128,
    "virtualMachineSize": "Standard_F4s_v2",
    "ubuntuVMSize": "Standard_F4s_v2",
    "vm1Name": "PRTG-Core-01",
    "vm2Name": "Remote-Probe-01",
    "vm3Name": "Multi-Platform-Probe",
    "vm4Name": "PRTG-Core-02",
    "nic1": "PRTG-Core-01-nic",
    "nic2": "Remote-Probe-01-nic",
    "nic3": "Multi-Platform-Probe-nic",
    "nic4": "PRTG-Core-02-nic",
    "nsg1": "PRTG-Core-01-nsg",
    "nsg2": "Remote-Probe-01-nsg",
    "nsg3": "Multi-Platform-Probe-nsg",
    "nsg4": "PRTG-Core-02-nsg",
    "pip1": "PRTG-Core-01-pip",
    "pip2": "Remote-Probe-01-pip",
    "pip3": "Multi-Platform-Probe-pip",
    "pip4": "PRTG-Core-02-pip",
    "pipDns1": "[concat('prtgcore01', uniqueString(resourceGroup().id))]",
    "pipDns2": "[concat('prtgprobe01', uniqueString(resourceGroup().id))]",
    "pipDns3": "[concat('multiplatformprobe', uniqueString(resourceGroup().id))]",
    "pipDns4": "[concat('prtgcore02', uniqueString(resourceGroup().id))]",
    "osDisk1": "PRTG-Core-01-OSDisk",
    "osDisk2": "Remote-Probe-01-OSDisk",
    "osDisk3": "Multi-Platform-Probe-OSDisk",
    "osDisk4": "PRTG-Core-02-OSDisk",
    "virtualNetworkName": "vnet",
    "vnetID": "[resourceId('Microsoft.Network/virtualNetworks', variables('virtualNetworkName'))]",
    "subnetRef": "[concat(variables('vnetID'), '/subnets/subnet')]",
    "adminUsername": "labuser",
    "adminUserPassword": "Password.1!!"
  },
  "resources": [
    {
      "name": "[variables('virtualNetworkName')]",
      "type": "Microsoft.Network/virtualNetworks",
      "apiVersion": "2018-02-01",
      "location": "[variables('location')]",
      "properties": {
        "addressSpace": { "addressPrefixes": ["10.0.0.0/16"] },
        "subnets": [{ "name": "subnet", "properties": { "addressPrefix": "10.0.0.0/24" } }]
      }
    },
    {
      "type": "Microsoft.Network/publicIpAddresses",
      "apiVersion": "2020-08-01",
      "name": "[variables('pip1')]",
      "location": "[variables('location')]",
      "sku": { "name": "Standard", "tier": "Regional" },
      "properties": {
        "publicIpAllocationMethod": "Static",
        "dnsSettings": { "domainNameLabel": "[variables('pipDns1')]" }
      }
    },
    {
      "type": "Microsoft.Network/networkSecurityGroups",
      "apiVersion": "2020-05-01",
      "name": "[variables('nsg1')]",
      "location": "[variables('location')]",
      "properties": {
        "securityRules": [
          { "name": "default-allow-rdp", "properties": { "priority": 110, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "3389" } },
          { "name": "default-allow-http", "properties": { "priority": 120, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "80" } },
          { "name": "default-allow-https", "properties": { "priority": 130, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "443" } }
        ]
      }
    },
    {
      "type": "Microsoft.Network/networkInterfaces",
      "apiVersion": "2022-11-01",
      "name": "[variables('nic1')]",
      "location": "[variables('location')]",
      "dependsOn": [
        "[concat('Microsoft.Network/virtualNetworks/', variables('virtualNetworkName'))]",
        "[concat('Microsoft.Network/publicIpAddresses/', variables('pip1'))]",
        "[concat('Microsoft.Network/networkSecurityGroups/', variables('nsg1'))]"
      ],
      "properties": {
        "ipConfigurations": [{
          "name": "ipconfig1",
          "properties": {
            "subnet": { "id": "[variables('subnetRef')]" },
            "privateIPAllocationMethod": "Dynamic",
            "publicIpAddress": { "id": "[resourceId('Microsoft.Network/publicIpAddresses', variables('pip1'))]" }
          }
        }],
        "networkSecurityGroup": { "id": "[resourceId('Microsoft.Network/networkSecurityGroups', variables('nsg1'))]" }
      }
    },
    {
      "type": "Microsoft.Compute/virtualMachines",
      "apiVersion": "2024-03-01",
      "name": "[variables('vm1Name')]",
      "location": "[variables('location')]",
      "dependsOn": ["[concat('Microsoft.Network/networkInterfaces/', variables('nic1'))]"],
      "properties": {
        "hardwareProfile": { "vmSize": "[variables('virtualMachineSize')]" },
        "storageProfile": {
          "osDisk": { "createOption": "FromImage", "name": "[variables('osDisk1')]", "caching": "ReadWrite", "managedDisk": { "storageAccountType": "[variables('diskType')]" }, "diskSizeGB": "[variables('diskSizeGB')]" },
          "imageReference": { "id": "[parameters('vm1ImageId')]" }
        },
        "osProfile": {
          "computerName": "prtgcore01",
          "adminUsername": "[variables('adminUsername')]",
          "adminPassword": "[variables('adminUserPassword')]"
        },
        "networkProfile": { "networkInterfaces": [{ "id": "[resourceId('Microsoft.Network/networkInterfaces', variables('nic1'))]" }] }
      }
    },
    {
      "type": "Microsoft.Compute/virtualMachines/extensions",
      "name": "[concat(variables('vm1Name'), '/winExtension')]",
      "apiVersion": "2015-06-15",
      "location": "[variables('location')]",
      "dependsOn": ["[concat('Microsoft.Compute/virtualMachines/', variables('vm1Name'))]"],
      "properties": {
        "publisher": "Microsoft.Compute",
        "type": "CustomScriptExtension",
        "typeHandlerVersion": "1.8",
        "autoUpgradeMinorVersion": true,
        "settings": {
          "fileUris": [
            "https://raw.githubusercontent.com/harshithgowda16/cric-agasthya-scoring-app/refs/heads/main/psscript.ps1",
            "https://experienceazure.blob.core.windows.net/templates/cloudlabs-common/cloudlabs-windows-functions.ps1"
          ]
        },
        "protectedSettings": {
          "commandToExecute": "[concat('powershell.exe -ExecutionPolicy Unrestricted -File psscript.ps1', variables('cloudlabsCommon'), variables('Enable-CloudLabsEmbeddedShadow'), ' -ComputerName prtgcore01')]"
        }
      }
    },
    {
      "type": "Microsoft.Network/publicIpAddresses",
      "apiVersion": "2020-08-01",
      "name": "[variables('pip2')]",
      "location": "[variables('location')]",
      "sku": { "name": "Standard", "tier": "Regional" },
      "properties": {
        "publicIpAllocationMethod": "Static",
        "dnsSettings": { "domainNameLabel": "[variables('pipDns2')]" }
      }
    },
    {
      "type": "Microsoft.Network/networkSecurityGroups",
      "apiVersion": "2020-05-01",
      "name": "[variables('nsg2')]",
      "location": "[variables('location')]",
      "properties": {
        "securityRules": [
          { "name": "default-allow-rdp", "properties": { "priority": 110, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "3389" } },
          { "name": "default-allow-http", "properties": { "priority": 120, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "80" } },
          { "name": "default-allow-https", "properties": { "priority": 130, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "443" } }
        ]
      }
    },
    {
      "type": "Microsoft.Network/networkInterfaces",
      "apiVersion": "2022-11-01",
      "name": "[variables('nic2')]",
      "location": "[variables('location')]",
      "dependsOn": [
        "[concat('Microsoft.Network/virtualNetworks/', variables('virtualNetworkName'))]",
        "[concat('Microsoft.Network/publicIpAddresses/', variables('pip2'))]",
        "[concat('Microsoft.Network/networkSecurityGroups/', variables('nsg2'))]"
      ],
      "properties": {
        "ipConfigurations": [{
          "name": "ipconfig1",
          "properties": {
            "subnet": { "id": "[variables('subnetRef')]" },
            "privateIPAllocationMethod": "Dynamic",
            "publicIpAddress": { "id": "[resourceId('Microsoft.Network/publicIpAddresses', variables('pip2'))]" }
          }
        }],
        "networkSecurityGroup": { "id": "[resourceId('Microsoft.Network/networkSecurityGroups', variables('nsg2'))]" }
      }
    },
    {
      "type": "Microsoft.Compute/virtualMachines",
      "apiVersion": "2024-03-01",
      "name": "[variables('vm2Name')]",
      "location": "[variables('location')]",
      "dependsOn": ["[concat('Microsoft.Network/networkInterfaces/', variables('nic2'))]"],
      "properties": {
        "hardwareProfile": { "vmSize": "[variables('virtualMachineSize')]" },
        "storageProfile": {
          "osDisk": { "createOption": "FromImage", "name": "[variables('osDisk2')]", "caching": "ReadWrite", "managedDisk": { "storageAccountType": "[variables('diskType')]" }, "diskSizeGB": "[variables('diskSizeGB')]" },
          "imageReference": { "id": "[parameters('vm2ImageId')]" }
        },
        "osProfile": {
          "computerName": "prtgprobe01",
          "adminUsername": "[variables('adminUsername')]",
          "adminPassword": "[variables('adminUserPassword')]"
        },
        "networkProfile": { "networkInterfaces": [{ "id": "[resourceId('Microsoft.Network/networkInterfaces', variables('nic2'))]" }] }
      }
    },
    {
      "type": "Microsoft.Compute/virtualMachines/extensions",
      "name": "[concat(variables('vm2Name'), '/winExtension')]",
      "apiVersion": "2015-06-15",
      "location": "[variables('location')]",
      "dependsOn": ["[concat('Microsoft.Compute/virtualMachines/', variables('vm2Name'))]"],
      "properties": {
        "publisher": "Microsoft.Compute",
        "type": "CustomScriptExtension",
        "typeHandlerVersion": "1.8",
        "autoUpgradeMinorVersion": true,
        "settings": {
          "fileUris": [
            "https://raw.githubusercontent.com/harshithgowda16/cric-agasthya-scoring-app/refs/heads/main/psscript.ps1",
            "https://experienceazure.blob.core.windows.net/templates/cloudlabs-common/cloudlabs-windows-functions.ps1"
          ]
        },
        "protectedSettings": {
          "commandToExecute": "[concat('powershell.exe -ExecutionPolicy Unrestricted -File psscript.ps1', variables('cloudlabsCommon'), variables('Enable-CloudLabsEmbeddedShadow'), ' -ComputerName prtgprobe01')]"
        }
      }
    },
    {
      "type": "Microsoft.Network/publicIpAddresses",
      "apiVersion": "2020-08-01",
      "name": "[variables('pip3')]",
      "location": "[variables('location')]",
      "sku": { "name": "Standard", "tier": "Regional" },
      "properties": {
        "publicIpAllocationMethod": "Static",
        "dnsSettings": { "domainNameLabel": "[variables('pipDns3')]" }
      }
    },
    {
      "type": "Microsoft.Network/networkSecurityGroups",
      "apiVersion": "2020-05-01",
      "name": "[variables('nsg3')]",
      "location": "[variables('location')]",
      "properties": {
        "securityRules": [
          { "name": "default-allow-ssh", "properties": { "priority": 110, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "22" } },
          { "name": "default-allow-http", "properties": { "priority": 120, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "80" } },
          { "name": "default-allow-https", "properties": { "priority": 130, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "443" } }
        ]
      }
    },
    {
      "type": "Microsoft.Network/networkInterfaces",
      "apiVersion": "2022-11-01",
      "name": "[variables('nic3')]",
      "location": "[variables('location')]",
      "dependsOn": [
        "[concat('Microsoft.Network/virtualNetworks/', variables('virtualNetworkName'))]",
        "[concat('Microsoft.Network/publicIpAddresses/', variables('pip3'))]",
        "[concat('Microsoft.Network/networkSecurityGroups/', variables('nsg3'))]"
      ],
      "properties": {
        "ipConfigurations": [{
          "name": "ipconfig1",
          "properties": {
            "subnet": { "id": "[variables('subnetRef')]" },
            "privateIPAllocationMethod": "Dynamic",
            "publicIpAddress": { "id": "[resourceId('Microsoft.Network/publicIpAddresses', variables('pip3'))]" }
          }
        }],
        "networkSecurityGroup": { "id": "[resourceId('Microsoft.Network/networkSecurityGroups', variables('nsg3'))]" }
      }
    },
    {
      "type": "Microsoft.Compute/virtualMachines",
      "apiVersion": "2024-03-01",
      "name": "[variables('vm3Name')]",
      "location": "[variables('location')]",
      "dependsOn": ["[concat('Microsoft.Network/networkInterfaces/', variables('nic3'))]"],
      "properties": {
        "hardwareProfile": { "vmSize": "[variables('ubuntuVMSize')]" },
        "storageProfile": {
          "osDisk": { "createOption": "FromImage", "name": "[variables('osDisk3')]", "caching": "ReadWrite", "managedDisk": { "storageAccountType": "[variables('diskType')]" }, "diskSizeGB": "[variables('diskSizeGB')]" },
          "imageReference": { "id": "[parameters('vm3ImageId')]" }
        },
        "osProfile": {
          "computerName": "prtgprobe02",
          "adminUsername": "[variables('adminUsername')]",
          "adminPassword": "[variables('adminUserPassword')]",
          "linuxConfiguration": {
            "disablePasswordAuthentication": false,
            "patchSettings": { "patchMode": "ImageDefault" }
          }
        },
        "networkProfile": { "networkInterfaces": [{ "id": "[resourceId('Microsoft.Network/networkInterfaces', variables('nic3'))]" }] }
      }
    },
    {
      "type": "Microsoft.Compute/virtualMachines/extensions",
      "name": "[concat(variables('vm3Name'), '/linuxExtension')]",
      "apiVersion": "2021-07-01",
      "location": "[variables('location')]",
      "dependsOn": ["[concat('Microsoft.Compute/virtualMachines/', variables('vm3Name'))]"],
      "properties": {
        "publisher": "Microsoft.Azure.Extensions",
        "type": "CustomScript",
        "typeHandlerVersion": "2.1",
        "autoUpgradeMinorVersion": true,
        "settings": {
          "fileUris": ["https://raw.githubusercontent.com/harshithgowda16/cric-agasthya-scoring-app/refs/heads/main/ptrg.sh"]
        },
        "protectedSettings": {
          "commandToExecute": "[concat('bash ptrg.sh ', parameters('resetUserPassword'))]"
        }
      }
    },
    {
      "type": "Microsoft.Network/publicIpAddresses",
      "apiVersion": "2020-08-01",
      "name": "[variables('pip4')]",
      "location": "[variables('location')]",
      "sku": { "name": "Standard", "tier": "Regional" },
      "properties": {
        "publicIpAllocationMethod": "Static",
        "dnsSettings": { "domainNameLabel": "[variables('pipDns4')]" }
      }
    },
    {
      "type": "Microsoft.Network/networkSecurityGroups",
      "apiVersion": "2020-05-01",
      "name": "[variables('nsg4')]",
      "location": "[variables('location')]",
      "properties": {
        "securityRules": [
          { "name": "default-allow-rdp", "properties": { "priority": 110, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "3389" } },
          { "name": "default-allow-http", "properties": { "priority": 120, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "80" } },
          { "name": "default-allow-https", "properties": { "priority": 130, "protocol": "TCP", "access": "Allow", "direction": "Inbound", "sourceAddressPrefix": "*", "sourcePortRange": "*", "destinationAddressPrefix": "*", "destinationPortRange": "443" } }
        ]
      }
    },
    {
      "type": "Microsoft.Network/networkInterfaces",
      "apiVersion": "2022-11-01",
      "name": "[variables('nic4')]",
      "location": "[variables('location')]",
      "dependsOn": [
        "[concat('Microsoft.Network/virtualNetworks/', variables('virtualNetworkName'))]",
        "[concat('Microsoft.Network/publicIpAddresses/', variables('pip4'))]",
        "[concat('Microsoft.Network/networkSecurityGroups/', variables('nsg4'))]"
      ],
      "properties": {
        "ipConfigurations": [{
          "name": "ipconfig1",
          "properties": {
            "subnet": { "id": "[variables('subnetRef')]" },
            "privateIPAllocationMethod": "Dynamic",
            "publicIpAddress": { "id": "[resourceId('Microsoft.Network/publicIpAddresses', variables('pip4'))]" }
          }
        }],
        "networkSecurityGroup": { "id": "[resourceId('Microsoft.Network/networkSecurityGroups', variables('nsg4'))]" }
      }
    },
    {
      "type": "Microsoft.Compute/virtualMachines",
      "apiVersion": "2024-03-01",
      "name": "[variables('vm4Name')]",
      "location": "[variables('location')]",
      "dependsOn": ["[concat('Microsoft.Network/networkInterfaces/', variables('nic4'))]"],
      "properties": {
        "hardwareProfile": { "vmSize": "[variables('virtualMachineSize')]" },
        "storageProfile": {
          "osDisk": { "createOption": "FromImage", "name": "[variables('osDisk4')]", "caching": "ReadWrite", "managedDisk": { "storageAccountType": "[variables('diskType')]" }, "diskSizeGB": "[variables('diskSizeGB')]" },
          "imageReference": { "id": "[parameters('vm4ImageId')]" }
        },
        "osProfile": {
          "computerName": "prtgcore02",
          "adminUsername": "[variables('adminUsername')]",
          "adminPassword": "[variables('adminUserPassword')]"
        },
        "networkProfile": { "networkInterfaces": [{ "id": "[resourceId('Microsoft.Network/networkInterfaces', variables('nic4'))]" }] }
      }
    },
    {
      "type": "Microsoft.Compute/virtualMachines/extensions",
      "name": "[concat(variables('vm4Name'), '/winExtension')]",
      "apiVersion": "2015-06-15",
      "location": "[variables('location')]",
      "dependsOn": ["[concat('Microsoft.Compute/virtualMachines/', variables('vm4Name'))]"],
      "properties": {
        "publisher": "Microsoft.Compute",
        "type": "CustomScriptExtension",
        "typeHandlerVersion": "1.8",
        "autoUpgradeMinorVersion": true,
        "settings": {
          "fileUris": [
            "https://raw.githubusercontent.com/harshithgowda16/cric-agasthya-scoring-app/refs/heads/main/psscript.ps1",
            "https://experienceazure.blob.core.windows.net/templates/cloudlabs-common/cloudlabs-windows-functions.ps1"
          ]
        },
        "protectedSettings": {
          "commandToExecute": "[concat('powershell.exe -ExecutionPolicy Unrestricted -File psscript.ps1', variables('cloudlabsCommon'), variables('Enable-CloudLabsEmbeddedShadow'), ' -ComputerName prtgcore02')]"
        }
      }
    }
  ],
  "outputs": {
    "Deployment ID": { "type": "String", "value": "[parameters('DeploymentID')]" },
    "VM1 PRTG Core 01 DNS Name": { "type": "String", "value": "[reference(resourceId('Microsoft.Network/publicIPAddresses', variables('pip1'))).dnsSettings.fqdn]" },
    "VM1 Admin Username": { "type": "String", "value": "training" },
    "VM1 Admin Password": { "type": "String", "value": "[parameters('resetUserPassword')]" },
    "VM1 Private IP": { "type": "String", "value": "[reference(concat('Microsoft.Network/networkInterfaces/', variables('nic1'))).ipConfigurations[0].properties.privateIPAddress]" },
    "VM2 Remote Probe 01 DNS Name": { "type": "String", "value": "[reference(resourceId('Microsoft.Network/publicIPAddresses', variables('pip2'))).dnsSettings.fqdn]" },
    "VM2 Admin Username": { "type": "String", "value": "training" },
    "VM2 Admin Password": { "type": "String", "value": "[parameters('resetUserPassword')]" },
    "VM2 Private IP": { "type": "String", "value": "[reference(concat('Microsoft.Network/networkInterfaces/', variables('nic2'))).ipConfigurations[0].properties.privateIPAddress]" },
    "VM3 Multi-Platform Probe DNS Name": { "type": "String", "value": "[reference(resourceId('Microsoft.Network/publicIPAddresses', variables('pip3'))).dnsSettings.fqdn]" },
    "VM3 Admin Username": { "type": "String", "value": "training" },
    "VM3 Admin Password": { "type": "String", "value": "[parameters('resetUserPassword')]" },
    "VM3 Private IP": { "type": "String", "value": "[reference(concat('Microsoft.Network/networkInterfaces/', variables('nic3'))).ipConfigurations[0].properties.privateIPAddress]" },
    "VM4 PRTG Core 02 DNS Name": { "type": "String", "value": "[reference(resourceId('Microsoft.Network/publicIPAddresses', variables('pip4'))).dnsSettings.fqdn]" },
    "VM4 Admin Username": { "type": "String", "value": "training" },
    "VM4 Admin Password": { "type": "String", "value": "[parameters('resetUserPassword')]" },
    "VM4 Private IP": { "type": "String", "value": "[reference(concat('Microsoft.Network/networkInterfaces/', variables('nic4'))).ipConfigurations[0].properties.privateIPAddress]" }
  }
}
